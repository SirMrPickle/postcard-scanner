# Postcard Digitization and Matching Tool

A high-throughput Python-based pipeline for digitizing, cropping, and matching physical postcard scans. Built for speed, consistency, and minimal manual intervention â€” optimized for batch processing and AWS-scale extension.

## ğŸ”§ Features

- ğŸ” **Auto-detects** and crops postcard regions from raw `.png` scans (front and back).
- ğŸ§  **Smart matching** of front and back images based on contour geometry (overlap area, center point proximity).
- ğŸ–¼ï¸ Saves debug overlays for visual QA:
  - âœ… **Green**: Successful front-back matches
  - ğŸ”´ **Red**: Orphaned front detections
  - ğŸ”µ **Blue**: Orphaned back detections
  - âšª **White**: All closed contours detected
- ğŸ§  **Warping & alignment** based on detected quadrilateral box
- ğŸ’¾ **Persistent caching** of contour and box data in JSON
- ğŸ§µ **Threaded matching** for faster execution
- ğŸ’» Built to support AWS / SageMaker pipelines (e.g., Textract + RDS)

## ğŸš€ How to Use

### 1. Drop Your Scans

Place your raw `.png` scans into the `_INPUT/` directory with consistent naming:

sc#-front.png
sc#-back.png

For example:

sc7-front.png
sc7-back.png

### 2. Run the Pipeline

**Manual Steps (per-stage debugging):**

python3 front-scanner-v4.py   # Detects & crops fronts
python3 back-scanner-v4.py    # Detects & crops backs
python3 combine-v5.py         # Matches frontâ†”back and saves combined results

**All-in-One Execution:**

python3 scan-master.py        # End-to-end threaded pipeline

## ğŸ“ Output Structure

### âœ… Results

- output/front/ â€” Cropped front images
- output/back/ â€” Cropped back images
- output/matched/ â€” Combined front-back postcards

### ğŸ§ª Debugging & QA

- debug/frontCoords.json â€” Cropping data (fronts)
- debug/backCoords.json â€” Cropping data (backs)
- debug/final/ â€” Matching overlays & composite debug images
- debug/contourData.txt â€” All contour metadata
- debug/cardContours.png â€” All card-sized contours
- debug/topContours.png â€” Top-ranked card shapes
- debug/closedBoxes.png â€” Final accepted boxes

## âš™ï¸ Requirements

- Python 3.8+
- opencv-python
- numpy
- shapely
- tqdm

Install them with:

``pip install opencv-python numpy shapely tqdm``

## ğŸ“Œ Notes & Tips

- This tool assumes your cards are:
  - Scanned on a solid **black** background
  - Rectangular and longer on one edge

## ğŸ› ï¸ Disclamer

This markdown file was created with the help of AI.
